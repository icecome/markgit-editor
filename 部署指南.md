# MarkGit Editor éƒ¨ç½²æŒ‡å—

**ç‰ˆæœ¬**: v1.2.0  
**æ›´æ–°æ—¥æœŸ**: 2026-02-28  

---

## ğŸ“‹ ç›®å½•

1. [éƒ¨ç½²æ¦‚è¿°](#éƒ¨ç½²æ¦‚è¿°)
2. [Docker éƒ¨ç½²](#docker-éƒ¨ç½²)
3. [ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²](#ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²)
4. [PaaS å¹³å°éƒ¨ç½²](#paas-å¹³å°éƒ¨ç½²)
5. [Serverless éƒ¨ç½²](#serverless-éƒ¨ç½²)
6. [è‡ªæ‰˜ç®¡ PaaS éƒ¨ç½²](#è‡ªæ‰˜ç®¡-paaS-éƒ¨ç½²)
7. [Kubernetes éƒ¨ç½²](#kubernetes-éƒ¨ç½²)
8. [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
9. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## éƒ¨ç½²æ¦‚è¿°

### é¡¹ç›®ç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ | éƒ¨ç½²å½±å“ |
|------|------|----------|
| FastAPI åç«¯ | Python Web æ¡†æ¶ | éœ€è¦ Python ç¯å¢ƒ |
| Git å‘½ä»¤è¡Œ | æ‰§è¡Œ Git æ“ä½œ | éœ€è¦å®‰è£… Git |
| æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ | ç”¨æˆ·åšå®¢ç¼“å­˜ | éœ€è¦æŒä¹…åŒ–å­˜å‚¨ |
| OAuth è®¤è¯ | GitHub ç™»å½• | éœ€è¦å…¬ç½‘è®¿é—® |
| ä¼šè¯ç®¡ç† | å†…å­˜/Redis | å¯é€‰ Redis |

### éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | éš¾åº¦ | æˆæœ¬ | æŒä¹…åŒ– | æ¨èåº¦ |
|------|----------|------|------|--------|--------|
| Docker | ä»»ä½•å¹³å° | â­â­ | ä¸­ç­‰ | âœ… | â­â­â­â­â­ |
| ä¼ ç»ŸæœåŠ¡å™¨ | VPSã€äº‘æœåŠ¡å™¨ | â­â­â­ | ä¸­ç­‰ | âœ… | â­â­â­â­ |
| Railway | å¿«é€Ÿéƒ¨ç½² | â­ | ä½ | âœ… | â­â­â­â­â­ |
| Render | å…è´¹å¥—é¤ | â­ | ä½ | âœ… | â­â­â­â­ |
| Fly.io | è¾¹ç¼˜éƒ¨ç½² | â­â­ | ä½ | âœ… | â­â­â­â­ |
| Zeabur | ç®€å•éƒ¨ç½² | â­ | ä½ | âœ… | â­â­â­â­ |
| Koyeb | å…¨çƒéƒ¨ç½² | â­â­ | ä¸­ç­‰ | âœ… | â­â­â­ |
| Coolify | è‡ªæ‰˜ç®¡ | â­â­â­ | ä½ | âœ… | â­â­â­â­ |
| Kubernetes | å¤§è§„æ¨¡ | â­â­â­â­ | é«˜ | âœ… | â­â­â­ |
| Cloudflare | è¾¹ç¼˜ | â­â­â­â­ | ä½ | âŒ | â­â­ |
| Vercel | Serverless | â­â­â­â­ | ä½ | âŒ | â­â­ |

---

## Docker éƒ¨ç½²

### 1. åˆ›å»º Dockerfile

```dockerfile
FROM python:3.11-slim

LABEL maintainer="MarkGit Editor"
LABEL version="1.2.0"

RUN apt-get update && apt-get install -y \
    git openssh-client curl \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .
RUN mkdir -p /app/blog_cache

RUN useradd -m -u 1000 appuser && chown -R appuser:appuser /app
USER appuser

EXPOSE 13131
ENV PYTHONUNBUFFERED=1 PRODUCTION=true PORT=13131

HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:13131/ || exit 1

CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "13131"]
```

### 2. Docker Compose

```yaml
version: '3.8'
services:
  markgit-editor:
    build: .
    ports: ["13131:13131"]
    environment:
      - PRODUCTION=true
      - GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
      - GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
      - REDIS_URL=redis://redis:6379/0
    volumes:
      - markgit-cache:/app/blog_cache
    depends_on: [redis]

  redis:
    image: redis:7-alpine
    volumes: [redis-data:/data]

volumes:
  markgit-cache:
  redis-data:
```

### 3. éƒ¨ç½²å‘½ä»¤

```bash
docker-compose up -d
docker-compose logs -f
```

---

## ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²

### å¿«é€Ÿéƒ¨ç½²è„šæœ¬

```bash
# ä¸‹è½½å¹¶è¿è¡Œ
curl -fsSL https://raw.githubusercontent.com/your-repo/markgit-editor/main/deploy/deploy.sh | bash -s -- your-domain.com
```

### æ‰‹åŠ¨éƒ¨ç½²

è¯¦è§ [deploy/deploy.sh](deploy/deploy.sh) å’Œ [deploy/nginx.conf](deploy/nginx.conf)ã€‚

---

## PaaS å¹³å°éƒ¨ç½²

### Railway (æ¨è â­â­â­â­â­)

**ä¼˜åŠ¿**: ä¸€é”®éƒ¨ç½²ã€è‡ªåŠ¨ SSLã€æŒä¹…åŒ–å­˜å‚¨ã€å†…ç½® Redis

#### 1. åˆ›å»º `railway.toml`

```toml
[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "uvicorn app:app --host 0.0.0.0 --port $PORT"
healthcheckPath = "/"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
```

#### 2. éƒ¨ç½²æ­¥éª¤

```bash
# å®‰è£… CLI
npm install -g @railway/cli

# ç™»å½•
railway login

# åˆå§‹åŒ–é¡¹ç›®
railway init

# æ·»åŠ  Redis
railway add --plugin redis

# è®¾ç½®ç¯å¢ƒå˜é‡
railway variables set GITHUB_CLIENT_ID=your_id
railway variables set GITHUB_CLIENT_SECRET=your_secret
railway variables set CORS_ORIGINS=https://your-app.up.railway.app
railway variables set PRODUCTION=true

# éƒ¨ç½²
railway up

# æ‰“å¼€åº”ç”¨
railway open
```

#### 3. æŒä¹…åŒ–å­˜å‚¨

Railway é»˜è®¤æä¾›æŒä¹…åŒ–å­˜å‚¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

---

### Render (æ¨è â­â­â­â­)

**ä¼˜åŠ¿**: å…è´¹å¥—é¤ã€è‡ªåŠ¨ SSLã€Docker æ”¯æŒ

#### 1. åˆ›å»º `render.yaml`

```yaml
services:
  - type: web
    name: markgit-editor
    env: docker
    dockerfilePath: ./Dockerfile
    envVars:
      - key: PRODUCTION
        value: true
      - key: GITHUB_CLIENT_ID
        sync: false
      - key: GITHUB_CLIENT_SECRET
        sync: false
      - key: REDIS_URL
        fromService:
          type: redis
          name: markgit-redis
          
  - type: redis
    name: markgit-redis
    plan: free
```

#### 2. éƒ¨ç½²æ­¥éª¤

1. è¿æ¥ GitHub ä»“åº“åˆ° Render
2. åˆ›å»ºæ–°çš„ Web Service
3. é€‰æ‹© Docker ç¯å¢ƒ
4. é…ç½®ç¯å¢ƒå˜é‡
5. æ·»åŠ  Redis æœåŠ¡

#### 3. æ³¨æ„äº‹é¡¹

- å…è´¹å¥—é¤ä¼šåœ¨ 15 åˆ†é’Ÿæ— æ´»åŠ¨åä¼‘çœ 
- æŒä¹…åŒ–å­˜å‚¨éœ€è¦ä»˜è´¹å¥—é¤

---

### Fly.io (æ¨è â­â­â­â­)

**ä¼˜åŠ¿**: å…¨çƒè¾¹ç¼˜éƒ¨ç½²ã€æŒä¹…åŒ–å­˜å‚¨ã€å…è´¹é¢åº¦

#### 1. åˆ›å»º `fly.toml`

```toml
app = "markgit-editor"
primary_region = "sin"

[build]
  dockerfile = "Dockerfile"

[env]
  PRODUCTION = "true"
  PORT = "13131"

[mounts]
  source = "markgit_data"
  destination = "/app/blog_cache"

[[services]]
  internal_port = 13131
  protocol = "tcp"

  [[services.ports]]
    handlers = ["http"]
    port = 80

  [[services.ports]]
    handlers = ["tls", "http"]
    port = 443

  [[services.tcp_checks]]
    interval = "30s"
    timeout = "5s"
    grace_period = "10s"
```

#### 2. éƒ¨ç½²æ­¥éª¤

```bash
# å®‰è£… CLI
curl -L https://fly.io/install.sh | sh

# ç™»å½•
fly auth login

# åˆ›å»ºåº”ç”¨
fly apps create markgit-editor

# åˆ›å»ºæŒä¹…åŒ–å­˜å‚¨
fly volumes create markgit_data --region sin --size 1

# è®¾ç½®ç¯å¢ƒå˜é‡
fly secrets set GITHUB_CLIENT_ID=your_id
fly secrets set GITHUB_CLIENT_SECRET=your_secret
fly secrets set CORS_ORIGINS=https://markgit-editor.fly.dev

# éƒ¨ç½²
fly deploy

# æ‰“å¼€åº”ç”¨
fly open
```

#### 3. æ·»åŠ  Redis

```bash
# åˆ›å»º Redis
fly redis create

# è¿æ¥ Redis
fly redis attach <redis-id>
```

---

### Zeabur (æ¨è â­â­â­â­)

**ä¼˜åŠ¿**: ä¸€é”®éƒ¨ç½²ã€ä¸­æ–‡ç•Œé¢ã€å…è´¹é¢åº¦

#### 1. éƒ¨ç½²æ­¥éª¤

1. è®¿é—® [zeabur.com](https://zeabur.com)
2. è¿æ¥ GitHub ä»“åº“
3. é€‰æ‹©é¡¹ç›®å¹¶éƒ¨ç½²
4. æ·»åŠ  Redis æœåŠ¡
5. é…ç½®ç¯å¢ƒå˜é‡

#### 2. é…ç½®æ–‡ä»¶

Zeabur è‡ªåŠ¨æ£€æµ‹ Dockerfileï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

---

### Koyeb (æ¨è â­â­â­)

**ä¼˜åŠ¿**: å…¨çƒéƒ¨ç½²ã€è‡ªåŠ¨æ‰©å±•

#### 1. éƒ¨ç½²æ­¥éª¤

```bash
# å®‰è£… CLI
go install github.com/koyeb/koyeb-cli/cmd/koyeb@latest

# ç™»å½•
koyeb login

# åˆ›å»ºåº”ç”¨
koyeb app create markgit-editor

# éƒ¨ç½²æœåŠ¡
koyeb service create markgit-editor \
  --app markgit-editor \
  --docker docker.io/your-username/markgit-editor \
  --ports 13131:http \
  --routes /:13131

# è®¾ç½®ç¯å¢ƒå˜é‡
koyeb service update markgit-editor \
  --env GITHUB_CLIENT_ID=your_id \
  --env GITHUB_CLIENT_SECRET=your_secret
```

---

## Serverless éƒ¨ç½²

### âš ï¸ é™åˆ¶è¯´æ˜

Serverless å¹³å°æœ‰ä»¥ä¸‹é™åˆ¶ï¼Œ**ä¸é€‚åˆç›´æ¥éƒ¨ç½²**ï¼š

| é™åˆ¶ | è¯´æ˜ | å½±å“ |
|------|------|------|
| æ— æ–‡ä»¶ç³»ç»Ÿ | å‡½æ•°æ˜¯æ— çŠ¶æ€çš„ | æ— æ³•æŒä¹…åŒ– blog_cache |
| æ—  Git å‘½ä»¤ | ç¯å¢ƒä¸æ”¯æŒ | æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨ |
| æ‰§è¡Œæ—¶é—´é™åˆ¶ | 10s-60s | Git æ“ä½œå¯èƒ½è¶…æ—¶ |

### æ›¿ä»£æ–¹æ¡ˆï¼šå‰ç«¯ + API åˆ†ç¦»

```
Serverless (å‰ç«¯é™æ€æ–‡ä»¶)
        â†“
    å¤–éƒ¨ API æœåŠ¡å™¨ (Docker/VPS)
        â†“
    GitHub API (Git æ“ä½œ)
```

### Cloudflare Pages

```bash
# éƒ¨ç½²å‰ç«¯é™æ€æ–‡ä»¶
wrangler pages deploy ./static

# API ä½¿ç”¨å¤–éƒ¨æœåŠ¡å™¨
# ä¿®æ”¹ main.js ä¸­çš„ API_BASE
```

### Vercel

```bash
# éƒ¨ç½²å‰ç«¯
vercel --prod

# API ä½¿ç”¨å¤–éƒ¨æœåŠ¡å™¨
# é…ç½® rewrites æŒ‡å‘ API
```

---

## è‡ªæ‰˜ç®¡ PaaS éƒ¨ç½²

### Coolify (æ¨è â­â­â­â­)

**ä¼˜åŠ¿**: å¼€æºå…è´¹ã€ç•Œé¢å‹å¥½ã€æ”¯æŒ Docker Compose

#### 1. å®‰è£… Coolify

```bash
curl -fsSL https://cdn.coollabs.io/coolify/install.sh | bash
```

#### 2. éƒ¨ç½²åº”ç”¨

1. è®¿é—® Coolify æ§åˆ¶é¢æ¿
2. åˆ›å»ºæ–°é¡¹ç›®
3. é€‰æ‹© Docker Compose éƒ¨ç½²
4. ä¸Šä¼  `docker-compose.yml`
5. é…ç½®ç¯å¢ƒå˜é‡
6. éƒ¨ç½²

---

### CapRover

**ä¼˜åŠ¿**: å¼€æºå…è´¹ã€ç®€å•æ˜“ç”¨

#### 1. å®‰è£… CapRover

```bash
docker run -p 80:80 -p 443:443 -p 3000:3000 -v /var/run/docker.sock:/var/run/docker.sock -v /captain:/captain caprover/caprover
```

#### 2. åˆ›å»º `captain-definition`

```json
{
  "schemaVersion": 2,
  "dockerfilePath": "./Dockerfile"
}
```

#### 3. éƒ¨ç½²

```bash
# å®‰è£… CLI
npm install -g caprover

# ç™»å½•
caprover login

# éƒ¨ç½²
caprover deploy
```

---

## Kubernetes éƒ¨ç½²

### 1. åˆ›å»º Deployment

```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: markgit-editor
spec:
  replicas: 2
  selector:
    matchLabels:
      app: markgit-editor
  template:
    metadata:
      labels:
        app: markgit-editor
    spec:
      containers:
      - name: markgit-editor
        image: your-registry/markgit-editor:latest
        ports:
        - containerPort: 13131
        env:
        - name: PRODUCTION
          value: "true"
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: markgit-secrets
              key: redis-url
        - name: GITHUB_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name: markgit-secrets
              key: github-client-id
        - name: GITHUB_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name: markgit-secrets
              key: github-client-secret
        volumeMounts:
        - name: blog-cache
          mountPath: /app/blog_cache
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
      volumes:
      - name: blog-cache
        persistentVolumeClaim:
          claimName: markgit-pvc
```

### 2. åˆ›å»º Service

```yaml
# k8s/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: markgit-editor
spec:
  selector:
    app: markgit-editor
  ports:
  - port: 80
    targetPort: 13131
  type: ClusterIP
```

### 3. åˆ›å»º Ingress

```yaml
# k8s/ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: markgit-editor
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
spec:
  tls:
  - hosts:
    - your-domain.com
    secretName: markgit-tls
  rules:
  - host: your-domain.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: markgit-editor
            port:
              number: 80
```

### 4. éƒ¨ç½²å‘½ä»¤

```bash
kubectl apply -f k8s/
```

---

## ç¯å¢ƒå˜é‡é…ç½®

### å¿…éœ€å˜é‡

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `GITHUB_CLIENT_ID` | GitHub OAuth å®¢æˆ·ç«¯ ID | `Ov23li...` |
| `GITHUB_CLIENT_SECRET` | GitHub OAuth å®¢æˆ·ç«¯å¯†é’¥ | `eb848b...` |

### å¯é€‰å˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `PRODUCTION` | `false` | ç”Ÿäº§ç¯å¢ƒæ ‡å¿— |
| `PORT` | `13131` | æœåŠ¡ç«¯å£ |
| `CORS_ORIGINS` | `http://localhost:13131` | å…è®¸çš„æ¥æº |
| `REDIS_URL` | - | Redis è¿æ¥åœ°å€ |
| `BLOG_CACHE_PATH` | `./blog_cache` | ç¼“å­˜ç›®å½• |
| `SESSION_TIMEOUT_HOURS` | `1` | ä¼šè¯è¶…æ—¶æ—¶é—´ |
| `MAX_CONCURRENT_SESSIONS` | `100` | æœ€å¤§å¹¶å‘ä¼šè¯æ•° |

---

## å¸¸è§é—®é¢˜

### Q1: Git æ“ä½œå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ç”¨æˆ·å·²é€šè¿‡ OAuth ç™»å½•
2. æ£€æŸ¥ OAuth token æ˜¯å¦æœ‰æ•ˆ
3. ç¡®ä¿ä»“åº“æƒé™æ­£ç¡®

### Q2: ä¼šè¯ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆ**:
1. é…ç½® Redis å­˜å‚¨
2. æ£€æŸ¥ `SESSION_TIMEOUT_HOURS` è®¾ç½®

### Q3: CORS é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `CORS_ORIGINS` é…ç½®
2. ç¡®ä¿åŒ…å«å‰ç«¯åŸŸå

---

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰

- [ ] é…ç½® GitHub OAuth åº”ç”¨
- [ ] è®¾ç½®ç¯å¢ƒå˜é‡
- [ ] å‡†å¤‡ SSL è¯ä¹¦
- [ ] é…ç½®åŸŸåè§£æ

### éƒ¨ç½²å

- [ ] æµ‹è¯• OAuth ç™»å½•
- [ ] æµ‹è¯• Git æ“ä½œ
- [ ] æ£€æŸ¥æ—¥å¿—è¾“å‡º
- [ ] é…ç½®ç›‘æ§å‘Šè­¦

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2026-02-28
